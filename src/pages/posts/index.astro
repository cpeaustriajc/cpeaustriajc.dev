---
import Post from "~/components/Post.astro";
import BaseLayout from "~/layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = await getCollection("posts", ({ data }) => {
  return import.meta.env.PROD ? data.draft !== true : true;
});

const sortedPosts = posts.sort(
  (a, b) => Number(b.data.publishDate) - Number(a.data.publishDate),
);

const meta = {
  description:
    "Collections of thoughts, essays, and articles about web development, design, and other things.",
  title: "Posts | John Carlo Austria",
  keywords: ["Blog", "Posts", "Essays", "Articles", "Thoughts"],
};
---

<BaseLayout {meta}>
  <main>
    <header>
      <h1>Posts</h1>
    </header>
    <ul>
      {sortedPosts.map((instance) => <Post posts={instance} />)}
    </ul>
  </main>
</BaseLayout>

<style>
  main {
    padding-inline: var(--size-3);
  }

  ul {
    list-style-type: none;
    display: grid;
    padding: unset;
    max-width: 1280px;
    gap: var(--size-4);
    grid-template-columns: repeat(2, minmax(320px, 1fr));
  }
</style>
