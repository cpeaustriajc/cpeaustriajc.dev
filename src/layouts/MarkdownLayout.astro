---
import Head from "@/components/Head.astro";
import type { Frontmatter as MarkdownContent } from "@/components/Posts.astro";
import DefaultLayout from "@/layouts/DefaultLayout.astro";
import { Picture } from "@astrojs/image/components";

interface MarkdownContentProps {
	content: MarkdownContent;
}

const { content } = Astro.props as MarkdownContentProps;

const getCorrectURL = (content: { image_url: string }) =>
	import.meta.env.PROD
		? content.image_url
		: (import("../" + content.image_url) as unknown as string);
---

<DefaultLayout>
	<Head slot="head" title={content.title} description={content.description} />
	<Fragment slot="content">
		<article
			class="prose md:prose-xl lg:prose-2xl dark:prose-invert dark:prose-a:text-blue-300 prose-a:text-blue-800"
		>
			<header>
				<h1>{content.title}</h1>
			</header>
			<figure class="text-center my-2 md:my-4 lg:my-8">
				<Picture
					src={getCorrectURL(content)}
					widths={[320, 640, 1280, 1920]}
					alt={content.image_alt}
					sizes="(min-width: 768px), 800px"
					aspectRatio="16:9"
					loading={"eager"}
					class="banner"
				/>
				<figcaption class="my-2 text-center text-sm font-bold">
					{content.image_alt}
				</figcaption>
			</figure>
			<slot />
		</article>
	</Fragment>
</DefaultLayout>

<style is:global>
	.banner img {
		border-radius: 0.375rem;
	}
</style>
