---
import Head from "@/components/Head.astro";
import DefaultLayout from "@/layouts/DefaultLayout.astro";
import type { Frontmatter as MarkdownContent } from "@/types/frontmatter";
import { getImage } from "@astrojs/image";
import { Picture } from "@astrojs/image/components";

interface MarkdownContentProps {
	content: MarkdownContent;
}

const { content } = Astro.props as MarkdownContentProps;
const { minutesRead } = Astro.props.frontmatter;

const { src } = await getImage({
	src: `/assets/${content.image_name}.jpeg`,
	width: 1200,
	height: 630,
	format: "jpeg",
});
---

<DefaultLayout>
	<Head slot="head">
		<title>{content.title}</title>
		<meta name="description" content={content.description} />
		<meta property="og:title" content={content.title} />
		<meta property="og:url" content={Astro.url.href} />
		<meta property="og:image" content={`${Astro.url.origin}${src}`} />

		<meta name="twitter:card" content="summary_large_image" />
		<meta property="twitter:domain" content="jaycedotbin.github.io" />
		<meta property="twitter:url" content={Astro.url.href} />
		<meta name="twitter:title" content={content.title} />
		<meta name="twitter:description" content={content.description} />
		<meta name="twitter:image" content={`${Astro.url.origin}${src}`} />
	</Head>

	<main slot="content">
		<header>
			<h1>{content.title}</h1>
			<p>
				<time datetime={content.date.format}>
					{content.date.content}
				</time>

				&mdash;

				{minutesRead}
			</p>
			<ul aria-label="Topics">
				{content.topics.map((topic) => <li>{topic}</li>)}
			</ul>
			<figure>
				<Picture
					src={import(`../assets/${content.image_name}.jpeg`)}
					sizes="(min-width: 50em) 360w, (min-width: 100em) 720w,"
					widths={[360, 720, 1280]}
					alt={content.image_alt}
					aspectRatio="16:9"
				/>
				<figcaption>
					{content.image_alt}
				</figcaption>
			</figure>
		</header>
		<article>
			<slot />
		</article>
	</main>
</DefaultLayout>

<style>
	main {
		margin: 0 2rem;
	}

	time {
		font-weight: 700;
		color: hsl(0, 0%, 9%);
	}

	ul {
		display: flex;
		flex-direction: row;
		list-style: none;
		gap: 0.5rem;
	}

	ul li {
		font-size: 0.75rem;
		line-height: 1rem;
		place-self: start;
		border-radius: 9999px;
		background-color: rgba(229, 229, 229, 1);
		padding: 0.25rem 0.5rem;
	}

	ul li::before {
		content: "â€¢";
	}

	article {
		max-width: 65ch;
	}

	article > p > img {
		border-radius: 0.5rem;
		margin: 0 auto;
	}

	figure {
		margin: 0.5rem;
		text-align: center;
	}

	figcaption {
		font-size: 0.75rem;
		font-weight: bold;
		line-height: 1rem;
		text-align: center;
	}

	picture > img {
		border-radius: 0.5rem;
	}

	@media (min-width: 768px) {
		figure {
			margin: 1rem 0;
		}
	}

	@media (min-width: 1024px) {
		main {
			margin: 0 auto;
		}

		figure {
			margin: 2rem 0;
		}
	}

	@media (prefers-color-scheme: dark) {
		time {
			color: hsl(0, 0%, 98%);
		}

		ul li {
			background-color: hsl(0, 0%, 15%);
		}
	}
</style>
